<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Harrison_Szemray" />

<meta name="date" content="2025-09-16" />

<title>Introduction to MetaboExploreR</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to MetaboExploreR</h1>
<h4 class="author">Harrison_Szemray</h4>
<h4 class="date">2025-09-16</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p><code>MetaboExploreR</code> is an R package that provides a
streamlined workflow for the processing and quality control of targeted
mass spectrometry data. It is designed to take raw vendor files and
produce concentration values ready for statistical analysis. The package
is built to be cross-platform compatible through the use of Docker.</p>
<p>The main workflow of the package is centred around three core
functions:</p>
<ul>
<li><code>msConvertR()</code>: Converts raw mass spectrometry vendor
files into the open-source mzML format.</li>
<li><code>PeakForgeR()</code>: Performs retention time correction, peak
picking, and integration.</li>
<li><code>qcCheckR()</code>: Handles quality control, batch correction,
and generates summary reports.</li>
</ul>
<p>This vignette will guide you through a complete example workflow
using the sample data provided with the package.</p>
</div>
<div id="installation" class="section level1">
<h1>Installation</h1>
<p>Before installing <code>MetaboExploreR</code>, you need to have
Docker Desktop installed on your system. You can download it from the
official Docker website: <a href="https://www.docker.com/get-started/" class="uri">https://www.docker.com/get-started/</a></p>
<p>Once Docker is installed and running, you can install
<code>MetaboExploreR</code> from GitHub using the following commands in
R:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/Hszemray/MetaboExploreR/master/R/install.R&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">install_MetaboExplorer</span>()</span></code></pre></div>
<p>After installation, load the package into your R session:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(MetaboExploreR)</span></code></pre></div>
</div>
<div id="workflow" class="section level1">
<h1>Workflow</h1>
<p>The <code>MetaboExploreR</code> workflow consists of four main steps.
We will use the example data included in the package to demonstrate the
workflow.</p>
<div id="project-setup" class="section level2">
<h2>1. Project Setup</h2>
<p>First, you need to set up a project directory with a specific
structure. The raw data files should be placed in a subdirectory named
<code>raw_data</code>.</p>
<p>For this vignette, we will use the example files provided with the
package. We will create a temporary directory for our project and copy
the necessary files into it.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Create a temporary directory for the project</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>project_dir <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># Create the raw_data subdirectory</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>raw_data_dir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(project_dir, <span class="st">&quot;raw_data&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">dir.create</span>(raw_data_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># For the purpose of this vignette, we assume that the raw files are in the raw_data_dir.</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># In a real analysis, you would place your vendor-specific raw files (e.g., .wiff) here.</span></span></code></pre></div>
</div>
<div id="msconvertr" class="section level2">
<h2>2. <code>msConvertR()</code></h2>
<p>The <code>msConvertR</code> function is used to convert
vendor-specific raw mass spectrometry files into the open-standard mzML
format. This step is crucial for ensuring that the data can be processed
by the downstream tools. Input and output locations can be
different.</p>
<p>Since we don’t have access to vendor raw files in this example, we
will skip this step. In a real-world scenario, you would run the
following command:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">msConvertR</span>(<span class="at">input_directory =</span> project_dir, <span class="at">output_directory =</span> project_dir)</span></code></pre></div>
<p>This would create mzML files in the appropriate directory
structure.</p>
</div>
<div id="peakforger" class="section level2">
<h2>3. <code>PeakForgeR()</code></h2>
<p>The <code>PeakForgeR</code> function is the core of the peak picking
and integration workflow. It takes the mzML files and an MRM transition
list as input and produces a report with the integrated peak areas.</p>
<p>The MRM transition list is a tab-separated file that contains
information about the molecules to be quantified. An example file,
<code>LGW_lipid_mrm_template_v1.tsv</code>, is included in the package.
Let’s inspect its contents.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>mrm_template_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;LGW_lipid_mrm_template_v1.tsv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;MetaboExploreR&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>mrm_template <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(mrm_template_path)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">head</span>(mrm_template)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt;   Molecule.List.Name Precursor.Name Precursor.Mz Precursor.Charge Product.Mz</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; 1                 CE       CE(14:0)        614.6                1      369.4</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; 2                 CE       CE(16:0)        642.6                1      369.4</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; 3                 CE       CE(16:1)        640.6                1      369.4</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; 4                 CE       CE(18:0)        670.6                1      369.4</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; 5                 CE       CE(18:1)        668.6                1      369.4</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; 6                 CE       CE(18:2)        666.6                1      369.4</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt;   Product.Charge Explicit.Retention.Time Explicit.Retention.Time.Window</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; 1              1                  11.600                            0.5</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; 2              1                  12.295                            0.5</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; 3              1                  11.615                            0.5</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; 4              1                  12.845                            0.5</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; 5              1                  12.310                            0.5</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; 6              1                  11.685                            0.5</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt;                        Note control_chart</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; 1 SIL_CE(16:0)_d7_Lipidyzer         FALSE</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; 2 SIL_CE(16:0)_d7_Lipidyzer          TRUE</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; 3 SIL_CE(16:1)_d7_Lipidyzer          TRUE</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; 4 SIL_CE(18:1)_d7_Lipidyzer         FALSE</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; 5 SIL_CE(18:1)_d7_Lipidyzer          TRUE</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">#&gt; 6 SIL_CE(18:2)_d7_Lipidyzer          TRUE</span></span></code></pre></div>
<p>For this example, we will use the pre-computed
<code>PeakForgeR</code> report that is included in the package. In a
real analysis, you would run the <code>PeakForgeR</code> function as
follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Path to the project directory</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>project_directory <span class="ot">&lt;-</span> <span class="st">&quot;path/to/your/project&quot;</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># List of MRM template files</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>mrm_template_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;LGW_lipid_mrm_template_v1.tsv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;MetaboExploreR&quot;</span>))</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="fu">PeakForgeR</span>(</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="at">user_name =</span> <span class="st">&quot;User&quot;</span>,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="at">project_directory =</span> project_directory,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="at">mrm_template_list =</span> mrm_template_list,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="at">QC_sample_label =</span> <span class="st">&quot;QC&quot;</span>, </span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="at">plateID_outputs =</span> <span class="cn">NULL</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>)</span></code></pre></div>
<p>The output of <code>PeakForgeR</code> is a CSV file containing the
integrated peak information for each sample and molecule. Let’s look at
the example report provided in the package.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>peakforger_report_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Example_PeakForgeR_report.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;MetaboExploreR&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>peakforger_report <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(peakforger_report_path)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">head</span>(peakforger_report)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt;     FileName MoleculeListName MoleculeName PrecursorMz ProductMz RetentionTime</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; 1 PLASMA_LTR               CE     CE(14:0)       614.6     369.4      11.65722</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; 2   Sample_1               CE     CE(14:0)       614.6     369.4      11.61070</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; 3 PLASMA_LTR               CE     CE(16:0)       642.6     369.4      12.33465</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; 4   Sample_1               CE     CE(16:0)       642.6     369.4      12.33795</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; 5 PLASMA_LTR               CE     CE(16:1)       640.6     369.4      11.63252</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; 6   Sample_1               CE     CE(16:1)       640.6     369.4      11.66010</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt;   StartTime  EndTime       Area     Height        AcquiredTime</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; 1  11.48432 11.75602   382663.0   71444.38 03/14/2021 05:33:51</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; 2  11.48720 11.75890   132454.2   23166.53 03/13/2021 16:21:44</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; 3  12.07065 12.56565  3879869.0  539971.88 03/14/2021 05:33:51</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; 4  12.07395 12.56895  4172605.2 1158824.12 03/13/2021 16:21:44</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; 5  11.43492 11.97832 15003148.0 4006770.00 03/14/2021 05:33:51</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; 6  11.43780 11.98120  9977041.0 2016591.00 03/13/2021 16:21:44</span></span></code></pre></div>
</div>
<div id="qccheckr" class="section level2">
<h2>4. <code>qcCheckR()</code></h2>
<p>The final step in the workflow is to perform quality control and
batch correction using the <code>qcCheckR</code> function. This function
takes the output from <code>PeakForgeR</code> and generates various
plots and reports to assess the quality of the data.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># In a real analysis, you would use the project directory where the PeakForgeR output is located.</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co"># qcCheckR can handle tsv and csv data inputs</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># See documentation ??MetaboExploreR::qcCheckR for further information.</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="fu">library</span>(MetaboExploreR)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#Load example mrm_template_list</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>                           <span class="st">&quot;LGW_lipid_mrm_template_v1.tsv&quot;</span>,</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>                           <span class="at">package =</span> <span class="st">&quot;MetaboExploreR&quot;</span>)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  sample_metadata_example <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(file_path)</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#Load example conc_guide</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>                           <span class="st">&quot;LGW_SIL_batch_Ultimate_2023_03_06.tsv&quot;</span>,</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>                           <span class="at">package =</span> <span class="st">&quot;MetaboExploreR&quot;</span>)</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>  sample_metadata_example <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(file_path)</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#Load example report file</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>                           <span class="st">&quot;Example_PeakForgeR_report.csv&quot;</span>,</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>                           <span class="at">package =</span> <span class="st">&quot;MetaboExploreR&quot;</span>)</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>  report_file <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file_path)</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#Run qcCheckR function</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="fu">qcCheckR</span>(<span class="at">user_name =</span> <span class="st">&quot;user1&quot;</span>,</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a>         <span class="at">project_directory =</span> <span class="st">&quot;path/to/project_directory&quot;</span>,</span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a>         <span class="at">mrm_template_list =</span> <span class="fu">list</span>(<span class="at">v1 =</span> <span class="fu">list</span>(</span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a>                                    <span class="at">SIL_guide =</span> path to<span class="sc">/</span>mrm_guide1.tsv,</span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a>                                    <span class="at">conc_guide =</span> path to<span class="sc">/</span>SIL_concentration_guide1.tsv),</span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a>                                  ),</span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a>         <span class="at">QC_sample_label =</span> <span class="st">&quot;qc&quot;</span>,</span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a>         <span class="at">sample_tags =</span> <span class="fu">c</span>(<span class="st">&quot;sample&quot;</span>,<span class="st">&quot;control&quot;</span>, <span class="st">&quot;qc&quot;</span>),</span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a>         <span class="at">mv_threshold =</span> <span class="fl">0.5</span>) <span class="co">#default is  0.5 for 50\% missing values</span></span></code></pre></div>
<p>The <code>qcCheckR</code> function generates an HTML report with
interactive plots, such as PCA plots and control charts, as well as an
Excel file with the final concentration data (contains a guide for
navigation).</p>
</div>
</div>
<div id="transition-list-and-conc-guide-development" class="section level1">
<h1>Transition List and conc guide development</h1>
<p>Although these functions are already inbuilt into the workflows. We
thought it would be helpful if users could check templates prior to
running the core functions to save time. There are two assistive
functions:</p>
<ol style="list-style-type: decimal">
<li><code>transition_checkR</code> Checks Q1 and Q3 transitions to
ensure all transitions are unique.</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>mrm_template_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;LGW_lipid_mrm_template_v1.tsv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;MetaboExploreR&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>mrm_template_df <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(mrm_template_path)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">transition_checkR</span>(mrm_template_df)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><code>compare_mrm_template_with_guide</code> Checks if all internal
standards from the <code>Note</code> column in the transition list has a
match in <code>SIL_name</code> of the concentration guide.</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>mrm_template_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;LGW_lipid_mrm_template_v1.tsv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;MetaboExploreR&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  mrm_template_df <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(mrm_template_path)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>conc_guide_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;LGW_SIL_batch_103.tsv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;MetaboExploreR&quot;</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  conc_guide_df <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(file_path)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="fu">compare_mrm_template_with_guide</span>(mrm_template_df, conc_guide_df)  </span></code></pre></div>
</div>
<div id="multi-cohort-project-setup" class="section level1">
<h1>Multi Cohort Project Setup</h1>
<p>Previously, we demonstrated how to set up MetaboExploreR for a single
cohort. However, the package also supports multi cohort analysis
provided that a consistent long-term reference material (LTR) has been
used across all cohorts. To enable this functionality, users must supply
the appropriate transition lists and concentration guides for each
cohort.</p>
<p>We know this may sound obvious, but it’s crucial to emphasise: The
same long-term reference material must be used across all plates. If
not, the results will be invalid due to inconsistencies in signal
correction.</p>
<p>Once PeakForgeR has completed its processing, qcCheckR will
automatically gather all reports from the project directory. Each
plate’s concentration data is processed using its respective transition
list and concentration guide. During signal drift and batch correction,
qcCheckR identifies plates run on different versions and aligns target
features across them. Signal drift and batch correction is first applied
to the long-term reference materials within each plate, and then across
all plates collectively.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Path to the project directory</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>project_directory <span class="ot">&lt;-</span> <span class="st">&quot;path/to/your/project&quot;</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># Create the raw_data subdirectory</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>raw_data_dir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(project_dir, <span class="st">&quot;raw_data&quot;</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="fu">dir.create</span>(raw_data_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co"># In a real analysis, you would place your vendor-specific raw files (e.g., .wiff and .wiff.scan) here. </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#Convert vendor files to mzml</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="fu">msConvertR</span>(<span class="at">input_directory =</span> project_dir, <span class="at">output_directory =</span> project_dir)</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#Provide transition list paths to PeakForgeR</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#It will cycle test each transition list on a plate until the match is found</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="fu">PeakForgeR</span>(</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>  <span class="at">user_name =</span> <span class="st">&quot;User&quot;</span>,</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>  <span class="at">project_directory =</span> project_directory,</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>  <span class="at">mrm_template_list =</span> <span class="fu">list</span>(<span class="at">v1 =</span> <span class="st">&quot;path to/mrm_guide1.tsv&quot;</span>,</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>                           <span class="at">v2 =</span> <span class="st">&quot;path to/mrm_guide2.tsv&quot;</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>                          ),</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>  <span class="at">QC_sample_label =</span> <span class="st">&quot;LTR&quot;</span>, </span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>  </span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>)</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co"># Provide transition lists and their respective concentration guide paths to qcCheckR</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="fu">qcCheckR</span>(<span class="at">user_name =</span> <span class="st">&quot;user&quot;</span>,</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>         <span class="at">project_directory =</span> <span class="st">&quot;path/to/project_directory&quot;</span>,</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>         <span class="at">mrm_template_list =</span> <span class="fu">list</span>(<span class="at">v1 =</span> <span class="fu">list</span>(</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a>                                    <span class="at">SIL_guide =</span> path to<span class="sc">/</span>mrm_guide1.tsv,</span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a>                                    <span class="at">conc_guide =</span> path to<span class="sc">/</span>SIL_concentration_guide1.tsv),</span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a>                                  <span class="at">v2 =</span> <span class="fu">list</span>(</span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a>                                    <span class="at">SIL_guide =</span> path to<span class="sc">/</span>mrm_guide2.tsv,</span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a>                                    <span class="at">conc_guide =</span> path to<span class="sc">/</span>SIL_concentration_guide2.tsv)</span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a>                                 ),</span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a>         <span class="at">QC_sample_label =</span> <span class="st">&quot;qc&quot;</span>,</span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a>         <span class="at">sample_tags =</span> <span class="fu">c</span>(<span class="st">&quot;sample&quot;</span>,<span class="st">&quot;control&quot;</span>, <span class="st">&quot;qc&quot;</span>),</span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a>         <span class="at">mv_threshold =</span> <span class="fl">0.5</span>) <span class="co">#default is  0.5 for 50\% missing values</span></span></code></pre></div>
</div>
<div id="session-info" class="section level1">
<h1>Session Info</h1>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt; R version 4.5.1 (2025-06-13 ucrt)</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; Running under: Windows 11 x64 (build 26100)</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; Matrix products: default</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt;   LAPACK version 3.12.1</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; locale:</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; [1] LC_COLLATE=English_Australia.utf8  LC_CTYPE=English_Australia.utf8   </span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; [3] LC_MONETARY=English_Australia.utf8 LC_NUMERIC=C                      </span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; [5] LC_TIME=English_Australia.utf8    </span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; time zone: Australia/Perth</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; tzcode source: internal</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; attached base packages:</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt;  [1] digest_0.6.37     R6_2.6.1          fastmap_1.2.0     xfun_0.53        </span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt;  [5] cachem_1.1.0      knitr_1.50        htmltools_0.5.8.1 rmarkdown_2.29   </span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt;  [9] lifecycle_1.0.4   cli_3.6.5         sass_0.4.10       jquerylib_0.1.4  </span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; [13] compiler_4.5.1    rstudioapi_0.17.1 tools_4.5.1       evaluate_1.0.5   </span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt; [17] bslib_0.9.0       yaml_2.3.10       rlang_1.1.6       jsonlite_2.0.0</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
